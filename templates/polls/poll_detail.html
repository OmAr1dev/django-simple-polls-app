{% extends 'base.html' %}

{% block title %}{{ poll.title }}{% endblock %}

{% block content %}
<h1>{{ poll.title }}</h1>
<p><strong>Created by:</strong> {{ poll.creator.username }}</p>
<p><strong>Status:</strong> {% if poll.is_closed %}Closed{% else %}Active{% endif %}</p>

{% if user == poll.creator %}
    <form method="post" style="display:inline;">
        {% csrf_token %}
        {% if not poll.is_closed %}
            <button type="submit" name="close_poll">Close Poll</button>
        {% endif %}
        <button type="submit" name="delete_poll" onclick="return confirm('Are you sure you want to delete this poll?');">Delete Poll</button>
    </form>
{% endif %}

{% if voted %}
    <p>You already voted!</p>
{% else %}
    <form method="post">
        {% csrf_token %}
        {% for choice in poll.choices.all %}
            <input type="radio" name="choice" value="{{ choice.id }}" required>
            {{ choice.text }}<br>
        {% endfor %}
        <button type="submit" name="vote">Vote</button>
    </form>
{% endif %}

<h2>Results:</h2>
<ul>
    {% for choice in poll.choices.all %}
        <li>{{ choice.text }}: {{ choice.votes }} votes</li>
    {% endfor %}
</ul>
{% endblock %}
