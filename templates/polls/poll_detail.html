{% extends 'base.html' %}

{% block title %}{{ poll.title }}{% endblock %}

{% block content %}
<h1>{{ poll.title }}</h1>

{% if user == poll.creator and not poll.is_closed %}
    <form method="post">
        {% csrf_token %}
        <button type="submit" name="close_poll">Close Poll</button>
    </form>
{% endif %}

{% if voted %}
    <p>You already voted!</p>
{% else %}
    <form method="post">
        {% csrf_token %}
        {% for choice in poll.choices.all %}
            <input type="radio" name="choice" value="{{ choice.id }}" required>
            {{ choice.text }}<br>
        {% endfor %}
        <button type="submit" name="vote">Vote</button>
    </form>
{% endif %}

<h2>Results:</h2>
<ul>
    {% for choice in poll.choices.all %}
        <li>{{ choice.text }}: {{ choice.votes }} votes</li>
    {% endfor %}
</ul>
{% endblock %}
